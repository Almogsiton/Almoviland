<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets">

    <h:panelGroup rendered="#{pageController.currentPage eq 'usersManagement'}">
        <h1>Users Management</h1>

        <!--  注转 砖转砖 驻  -->
        #{userBean.ensureUsersLoaded()}

        <!--  驻转专 专  拽专 -->
        <h:form>
            <h:commandButton value=" Back to Dashboard" action="#{pageController.setPage('admin')}">
                <f:ajax execute="@form" render="@all"/>
            </h:commandButton>
        </h:form>

        <!--  转 砖转砖 -->
        <h:form id="userTableForm">
            <h:dataTable value="#{userBean.users}" var="user" border="1">
                <h:column>
                    <f:facet name="header">User ID</f:facet>
                    #{user.userId}
                </h:column>
                <h:column>
                    <f:facet name="header">Name</f:facet>
                    #{user.name}
                </h:column>
                <h:column>
                    <f:facet name="header">Email</f:facet>
                    #{user.email}
                </h:column>
                <h:column>
                    <f:facet name="header">Role</f:facet>
                    #{user.role}
                </h:column>
                <h:column>
                    <f:facet name="header">Registration Date</f:facet>
                    #{user.dateRegistration}
                </h:column>

                <h:column>
                    <f:facet name="header">Actions</f:facet>

                    <!--  驻转专 砖 转驻拽 -->
                    <h:commandButton value="Change Role"
                                     action="#{userBean.toggleUserRole(user.userId)}"
                                     onclick="return confirm('Are you sure you want to change this user\'s role?');">
                        <f:ajax execute="@this" render="@all"/>
                    </h:commandButton>

                    <!--  驻转专 拽转 砖转砖 -->
                    <h:commandButton value="Delete"
                                     action="#{userBean.deleteUser(user.userId)}"
                                     onclick="return confirm('Are you sure you want to delete this user?');">
                        <f:ajax execute="@this" render="@all"/>
                    </h:commandButton>

                    <!--  驻转专 爪转 住专转 砖转 -->
                    <h:commandButton value="View Borrowing History"
                                     action="#{userBean.viewUserBorrowingHistory(user.userId)}">
                        <f:ajax execute="@this" render="@all"/>
                    </h:commandButton>
                </h:column>
            </h:dataTable>
        </h:form>
    </h:panelGroup>
</ui:composition>
